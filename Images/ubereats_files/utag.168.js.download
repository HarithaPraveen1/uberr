//tealium universal tag - utag.168 ut4.0.202308311621, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={id:id};utag.o[loader].sender[id]=u;u.ev={view:1,link:1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.callback=function(){u.initialized=true;twq('config',u.data.pixelId);u.data.events.forEach(function(event){twq('event',event,u.data[event]);});};u.map={"ut.event:view":"tw-o43i6-oc3wp","funnel_step:1":"tw-o43i6-oc3wx","funnel_step:3":"tw-o43i6-oc3wr","funnel_step:5":"tw-o43i6-oc3wt","funnel_step:6":"tw-o43i6-oc3wu","funnel_step:4":"tw-o43i6-oc3ws","FB_TutorialCompleted:true":"tw-o43i6-oc3ww","_cprod":"product_id","_cquan":"product_quantity","currency_code":"tw-o43i6-oc3wr.currency,tw-o43i6-oc3ws.currency,tw-o43i6-oc3wt.currency,tw-o43i6-oc3wu.currency,tw-o43i6-oc3ww.currency","product_price":"tw-o43i6-oc3ws.value","price_total":"tw-o43i6-oc3wt.value,tw-o43i6-oc3wu.value,tw-o43i6-oc3ww.value","hashedEmail":"tw-o43i6-oc3wp.email_address,tw-o43i6-oc3wx.email_address,tw-o43i6-oc3wr.email_address,tw-o43i6-oc3ws.email_address,tw-o43i6-oc3wt.email_address,tw-o43i6-oc3wu.email_address,tw-o43i6-oc3ww.email_address","searchTopRestList":"tw-o43i6-oc3wp.contents,tw-o43i6-oc3wx.contents","restaurant_id":"tw-o43i6-oc3wr.contents,tw-o43i6-oc3ws.contents,tw-o43i6-oc3wt.contents,tw-o43i6-oc3wu.contents,tw-o43i6-oc3ww.contents"};u.extend=[function(a,b){try{if((b['funnel_step'].toString().toLowerCase().indexOf('6'.toLowerCase())>-1&&b['newOrReturning'].toString().toLowerCase().indexOf('new'.toLowerCase())>-1)){b['FB_TutorialCompleted']='true'}}catch(e){utag.DB(e);}},function(a,b){try{if(1){if(b.eventLabel.indexOf('place-order|order-id')>-1){var orderId=b.eventLabel.split(":")[b.eventLabel.split(":").length-1];b.orderId=orderId||'';b.fb_order_id="ewtpo_"+orderId;if(b.newOrReturning==="new"){b.fb_order_id_ft="ewft_"+orderId;}
result=[];for(var i=0;i<b.product_quantity.length;i++){test={'id':b.menu_id[i],'quantity':b.product_quantity[i]};result.push(test)}
restaurantData={'id':b.restaurant_id,'quantity':"1",'item_price':b.price_total};result.push(restaurantData);b.fb_contents=result;}
if(b.eventLabel.indexOf('remove-from-cart|')>-1){var removeFromCart=b.eventLabel.split('|')[0];b.removeFromCart=removeFromCart||'';}
if(typeof(b.userId)!=="undefined"&&b.userId.length>0){b.fb_var=b.userId;}else{b.fb_var=b["cp.marketing_vistor_id"];}
if(b.eventLabel.indexOf('add-to-cart|')>-1){result=[]
test={'id':b.menu_id.toString(),'quantity':b.quantity};result.push(test)
restaurantData={'id':b.restaurant_id,'quantity':"1",'item_price':parseFloat(b.product_price)};result.push(restaurantData);b.fb_contents=result;}
if(b.eventLabel.indexOf('restaurant-list')>-1&&b.eventName.indexOf('stores_eats')>-1){b.searchTopRestList=b.restaurant_list.slice(0,10);}
if((typeof(b.restaurant_id)!=="undefined"&&b.restaurant_id.length>0)&&(typeof(b.menu_id)!=="undefined"&&b.menu_id.length>0)){b.fb_content_ids=[];b.fb_content_ids=[b.restaurant_id];b.fb_content_ids=b.fb_content_ids.concat(b.menu_id);}}}catch(e){utag.DB(e)}}];u.send=function(utag_event,data_layer){if(u.ev[utag_event]||u.ev.all!==undefined){utag.DB('send:168');utag.DB(data_layer);var a,b,c,d,e,f,g,h,query_params;a=utag_event;b=data_layer;u.data={base_url:'https://static.ads-twitter.com/uwt.js',pixelId:'o43i6',email_address:'',phone_number:'',external_id:'',search_string:'',description:'',twclid:'',order_total:'',order_currency:'',order_id:'',product_category:'',product_skus:'',product_names:'',product_unit_price:'',product_quantity:'',content_group_id:'',events:[]};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){if(typeof utag_err!='undefined'){utag_err.push({e:'extension error:'+e,s:utag.cfg.path+'utag.'+id+'.js',l:c,t:'ex'})}}};utag.DB('send:168:EXTENSIONS');utag.DB(data_layer);query_params=[];Object.keys(utag.loader.GV(u.map)).forEach(function(mapping_key){if(data_layer[mapping_key]!==undefined&&data_layer[mapping_key]!==''){var destinations=u.map[mapping_key].split(',');destinations.forEach(function(parameter){if(u.data.hasOwnProperty(parameter)||parameter.indexOf('.')>-1){u.map_func(parameter.split('.'),u.data,data_layer[mapping_key]);}});}else{var event_destinations=mapping_key.split(':');if(event_destinations.length===2&&String(data_layer[event_destinations[0]])===String(event_destinations[1])){if(u.map[mapping_key]){u.data.events=u.data.events.concat(u.map[mapping_key].split(','));}}}});utag.DB('send:168:MAPPINGS');utag.DB(u.data);var eCommerceMapping=[{eCommerceData:data_layer._ctotal,name:'order_total',isArray:false},{eCommerceData:data_layer._ccurrency,name:'order_currency',isArray:false},{eCommerceData:data_layer._corder,name:'order_id',isArray:false},{eCommerceData:data_layer._ccat,name:'product_category',isArray:true},{eCommerceData:data_layer._csku,name:'product_skus',isArray:true},{eCommerceData:data_layer._cprodname,name:'product_names',isArray:true},{eCommerceData:data_layer._cprice,name:'product_unit_price',isArray:true},{eCommerceData:data_layer._cquan,name:'product_quantity',isArray:true}];eCommerceMapping.forEach(function(dataObject){if(!dataObject.isArray){u.data[dataObject.name]=u.data[dataObject.name]||dataObject.eCommerceData||'';}else if(u.data[dataObject.name].length===0&&dataObject.eCommerceData!==undefined&&dataObject.isArray){u.data[dataObject.name]=dataObject.eCommerceData.slice(0);}});if(!u.data.pixelId){utag.DB(u.id+': Tag not fired: Required attribute Pixel Id not populated');return;}
if(u.initialized){u.callback();}else{if(!u.scriptrequested){u.scriptrequested=true;!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);},s.version='1.1',s.queue=[]);}(window,document,'script');utag.ut.loader({'type':'script','src':u.data.base_url,'cb':u.callback,'loc':'script','id':'utag_168','attrs':{}});}}
utag.DB('send:168:COMPLETE');}};utag.o[loader].loader.LOAD(id);}('168','uber.eatsv2'));}catch(error){utag.DB(error);}
